<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Luvo â€“ Local Business</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background: linear-gradient(180deg, #4caad8 0%, #71c7b8 100%);
            min-height: 100vh;
        }
        .temp-navbar {
            height: 56px;
            background: #377fb6;
            display: flex;
            align-items: center;
            padding: 0 1.5rem;
            color: white;
            font-weight: 600;
            font-size: 1.1rem;
        }
        .listing-card {
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
    </style>
</head>

<body>

<div class="temp-navbar">
    Luvo | Local Business
</div>

<div class="container mt-4">

    <h2 class="text-center">Local Business</h2>

    <div th:if="${successMessage}" class="alert alert-success text-center" th:text="${successMessage}"></div>

    <!-- FORM -->
    <div class="card p-4 mt-4">
        <h4 th:text="${editing} ? 'Edit Listing' : 'Add Listing'"></h4>

        <form th:action="@{/business}" th:object="${localBusiness}" method="post" enctype="multipart/form-data">

            <input type="hidden" th:field="*{id}">
            <input type="hidden" th:field="*{imagePath}">

            <div class="row mb-3">
                <div class="col-md-6">
                    <label>Name</label>
                    <input class="form-control" th:field="*{name}">
                    <div class="text-danger" th:errors="*{name}"></div>
                </div>

                <div class="col-md-6">
                    <label>Category</label>
                    <input class="form-control" th:field="*{category}">
                    <div class="text-danger" th:errors="*{category}"></div>
                </div>
            </div>

            <div class="mb-3">
                <label>Description</label>
                <input class="form-control" th:field="*{description}">
                <div class="text-danger" th:errors="*{description}"></div>
            </div>

            <div class="mb-3">
                <label>Image</label>
                <input type="file" name="imageFile" class="form-control" th:attr="required=${!editing}">
                <div class="text-danger" th:errors="*{imagePath}"></div>
            </div>

            <div class="row mb-3">
                <div class="col-md-4">
                    <label>Phone</label>
                    <input class="form-control" th:field="*{phone}">
                    <div class="text-danger" th:errors="*{phone}"></div>
                </div>

                <div class="col-md-4">
                    <label>Email</label>
                    <input class="form-control" th:field="*{email}">
                    <div class="text-danger" th:errors="*{email}"></div>
                </div>

                <div class="col-md-4">
                    <label>Price Range</label>
                    <input class="form-control" th:field="*{priceRange}" placeholder="$ - $$">
                    <div class="text-danger" th:errors="*{priceRange}"></div>
                </div>
            </div>

            <button type="submit" class="btn btn-danger w-100"
                    th:text="${editing} ? 'Update' : 'Add'"></button>
        </form>
    </div>

    <!-- LISTINGS -->
    <h3 class="mt-5">My Listings</h3>

    <div class="row mt-3">
        <div class="col-md-4 mb-4" th:each="b : ${businesses}">
            <div class="card listing-card p-3">
                <div th:if="${b.imagePath}">
                    <img th:src="${b.imagePath}" class="img-fluid mb-3" style="height:150px;object-fit:cover;">
                </div>

                <h5 th:text="${b.name}"></h5>
                <p class="text-muted" th:text="${b.category}"></p>
                <p th:text="${b.description}"></p>
                <p class="fw-bold" th:text="${b.priceRange}"></p>

                <div class="d-flex justify-content-between mt-3">
                    <a th:href="@{'/business/edit/' + ${b.id}}" class="btn btn-sm btn-primary">Edit</a>
                    <a th:href="@{'/business/delete/' + ${b.id}}" class="btn btn-sm btn-danger">Delete</a>
                </div>
            </div>
        </div>
    </div>

</div>

</body>
</html>
